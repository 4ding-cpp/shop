kind: pipeline
type: docker
name: 4d-shop
steps:
# - name: build-shop
#   image: node:12.9.1-alpine
#   commands:
#   - npm install
#   - npm run build
- name: publish-shop
  image: plugins/docker
  when:
    branch: master
    event: push
  settings:
    username:
      from_secret: docker_hub_username
    password:
      from_secret: docker_hub_password
    repo: 4ding/shop-client
    cache_from: 4ding/shop-client
    tags:
    - 'latest'
    - '0.0.0'
    dockerfile: drone-ci/Dockerfile
# - name: deploy-shop-client
#   image: danielgormly/drone-plugin-kube
#   settings:
#     ca:
#       from_secret: k8s_ca
#     server:
#       from_secret: k8s_master
#     template: drone-ci/deployment.yaml
#     token:
#       from_secret: k8s_token